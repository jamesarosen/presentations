<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=1024, user-scalable=no">

    <title>JavaScript Tools for Developer Happiness</title>

    <link rel="stylesheet" href="../deck/core/deck.core.css">
    <link rel="stylesheet" href="../deck/extensions/status/deck.status.css">
    <link rel="stylesheet" href="../deck/extensions/hash/deck.hash.css">
    <link rel="stylesheet" href="../deck/extensions/scale/deck.scale.css">
    <link rel="stylesheet" href="../deck/themes/transition/vertical-slide.css">
    <link rel="stylesheet" href="../deck/themes/style/zendesk.css">

    <script src="../deck/assets/modernizr.custom.js"></script>
  </head>
  <body class="deck-container">
    <!-- slides -->

    <section class="slide chapter green">
      <h1>
        JavaScript Tools<br />For Developer Happiness
        <cite>https://github.com/jamesarosen/presentations/javascript_equipment</cite>
      </h1>
    </section>

    <section class="slide chapter green">
      <h1>
        <img src="../deck/themes/style/buddhy.png" />
      </h1>
    </section>

    <section class="slide chapter green">
      <h1>Chapter 0: <code>whoami</code></h1>
    </section>

    <section class='slide'>
      <p>James A. Rosen</p>
      <p>Senior User Happiness Engineer, Zendesk</p>
      <p>@jamearosen</p>
      <p>https://github.com/jamesarosen</p>
    </section>

    <section class='slide chapter green'>
      <h1>Chapter 1: Tools Philosophy</h1>
    </section>

    <section class='slide'>
      <header>Working</header>
      <figure>
        <img src="./assets/broken_wrench.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/9115274@N05/577382652/'>
            http://www.flickr.com/photos/9115274@N05/577382652/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class='slide'>
      <header>Fast</header>
      <figure>
        <img src="./assets/cheetah.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/geyring/5290188093/'>
            http://www.flickr.com/photos/geyring/5290188093/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class='slide'>
      <header>Slow is OK</header>
      <figure>
        <img src="./assets/turkish_tea.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/mbgrigby/5161070259/'>
            http://www.flickr.com/photos/mbgrigby/5161070259/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class='slide'>
      <header>Polyglot</header>
      <figure>
        <img src="./assets/polyglot.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/quinnanya/5383598076/'>
            http://www.flickr.com/photos/quinnanya/5383598076/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class='slide'>
      <header>Overview</header>
      <p class='slide inline'>JSHint</p>
      <p class='slide inline'>Shell Scripting</p>
      <p class='slide inline'>CommonJS &amp; Browserify</p>
      <p class='slide inline'>Make &amp; Rake</p>
      <p class='slide inline'>File Watchers</p>
    </section>

    <section class="slide chapter green">
      <h1>Chapter 2: <code>insistent_cat.js</code></h1>
    </section>

    <section class="slide">
      <header>User Story: Catness</header>
      <p>As a cat,</p>
      <p>I want to be directly under your hand, wherever it happens to be, regardless of what you are doing, all the time</p>
      <p>So that I epitomize catness.</p>
      <p><cite>
        <a href="https://twitter.com/catuserstories/status/311275434669142019" class='odd-eyed-cat'>
          https://twitter.com/catuserstories/status/311275434669142019
        </a>
      </cite></p>
    </section>

    <section class='slide'>
      <figure>
        <img src="./assets/odd_eyed_cat.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/ihasb33r/2573196546/'>
            http://www.flickr.com/photos/ihasb33r/2573196546/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class="slide chapter green">
      <h1>
        Chapter 3: JSHint<br />
        <span class='subtitle'>The <i>Sine Qua Non</i> of JavaScript Development</span>
      </h1>
    </section>

    <section class="slide">
      <header><i>Sine Qua Non</i></header>
      <pre>/ˌsaɪnɨ kweɪ ˈnɒn/ or /ˈsine kwaː ˈnoːn/

If you don't use this, I will smack you with a fish.

Origin: L, without which not</pre>
    </section>

    <section class='slide'>
      <header>Fish Slap</header>
      <img src='./assets/slap_with_fish.png' />
    </section>

    <section class="slide">
      <header>JSHint Installation</header>
      <p class='slide'>Go to <a href="http://nodejs.org/">http://nodejs.org/</a></p>
      <p class='slide'>Install NodeJS</a></p>
      <p class='slide'><code>npm install -g jshint</code><br />(more on this later)</p>
    </section>

    <section class="slide">
      <header>JSHint Usage</header>
      <pre class='slide'>jshint assets/insistent_cat.js</pre>
      <pre class='slide'>assets/insistent_cat.js: line 21, col 53,
Expected an assignment or function call and instead saw an expression.</pre>
    </section>

    <section class='slide'>
      <header>Before &amp; After</header>
      <pre class='slide'>cat.following ? cat.unfollow() : cat.follow();</pre>
      <pre class='slide'>if (cat.following) {
  cat.unfollow();
} else {
 cat.follow();
}</pre>
    </section>

    <section class='slide'>
      <header>JSHint Options</header>
      <p class='slide'><code>curly</code>: require <code>{...}</code></p>
      <p class='slide'><code>eqeqeq</code>: require <code>===</code> and <code>!==</code></p>
      <p class='slide'><code>undef</code>: spot leaked globals</p>
      <p class='slide'><code>unused</code>: spot extra variables</p>
      <p class='slide'>
        More at
        <a href="http://jshint.com/docs/#options">http://jshint.com/docs/#options</a>
      </p>
    </section>

    <section class='slide'>
      <header>JSHint: Multiple Versions</header>
      <p>
        You work on many projects; each prefers a specific version of JSHint
      </pre>
    </section>

    <section class='slide'>
      <header>Install Locally</header>
      <pre class='slide'>{
  "devDependencies": {
    "jshint": "~1.1.0"
  }
}</pre>
      <pre class='slide'>npm install</pre>
      <p class='slide'>Ignore warnings about <code>-g</code></p>
    </section>

    <section class='slide'>
      <header>Run Locally</header>
      <pre><em>node_modules/jshint/bin/jshint</em> myFile.js</pre>
    </section>

    <section class='slide'>
      <header>JSHint: Bonus Points</header>
      <p class='slide'>Run from editor w/ keyboard shortcut</p>
      <p class='slide'>Run from editor on save</p>
      <p class='slide'>Add to git pre-commit hook</p>
      <p class='slide'>Run in <abbr title="Continuous Integration">CI</abbr></p>
    </section>

    <section class="slide chapter green">
      <h1>Chapter 4: Working with Multiple Files</h1>
    </section>

    <section class='slide'>
      <header>JSHint: Multiple Files</header>
      <pre>node_modules/jshint/bin/jshint src</pre>
    </section>

    <section class='slide'>
      <header>Refactor</header>
      <p>In <code>script/hint</code>:</p>
      <pre>#!/bin/sh
node_modules/jshint/bin/jshint src</pre>
    </section>

    <section class='slide'>
      <header><code>cat</code></header>
      <pre>cat src/cat_image.js \
  src/cat_follower.js \
  > assets/insistent_cat.js</pre>
    </section>

    <section class='slide'>
      <header>Problem!</header>
      <pre><em>(function(window, $, undefined) {</em>

  // contents go here

  window.InsistentCat = InsistentCat;

<em>}(this, this.jQuery));</em></pre>
    </section>

    <section class='slide'>
      <header>"Solution"</header>
      <p>In <code>script/build</code>:</p>
      <pre>#!/bin/sh
outfile="build/library.js"
echo "(function(window, $, undefined) {"    >  $outfile;
cat  src/cat_image.js                       >> $outfile;
cat  src/cat_follower.js                    >> $outfile;
echo "window.InsistentCat = InsistentCat;"  >> $outfile;
echo "}(this, this.jQuery));"               >> $outfile;</pre>
    </section>

    <section class="slide chapter green">
      <h1>Chapter 5: Modularization</h1>
    </section>

    <section class='slide'>
      <header>Benefits</header>
      <p class='slide'>Dependencies are obvious</p>
      <p class='slide'>Test in isolation</p>
      <p class='slide'>Avoid global namespace pollution</p>
    </section>

    <section class='slide'>
      <header>Options</header>
      <p class='slide'>AMD - still "globals"</p>
      <p class='slide'>
        ES6 Modules (<code>es6-module-transpiler</code>) - promising, but
        in flux.
      </p>
      <p class='slide'>CommonJS - already using <code>npm</code>; large library set.</p>
    </section>

    <section class='slide'>
      <header>Export</header>
      <pre>// in cat_image.js:
<em>module.exports</em> = function buildCatImage(src, options) {
  // ...
};</pre>
    </section>

    <section class='slide'>
      <header>Import</header>
      <pre>// in cat_follower.js:
var <em>buildImage = require('./cat_image')</em>;
// ...
var catImage = buildImage('path/to/cat.png', { width: '20px' });
</pre>
    </section>

    <section class='slide'>
      <header>CommonJS -> Browser Compilers</header>
      <p class='slide'><a href="https://github.com/azer/onejs">OneJS</a></p>
      <p class='slide'><a href="https://github.com/mixu/gluejs">GlueJS</a></p>
      <p class='slide'><a href="https://github.com/substack/node-browserify">Browserify</a></p>
      <p class='slide'>Custom Shell Script</p>
    </section>

    <section class='slide'>
      <header>Caution!</header>
      <figure>
        <img src="./assets/motorcycle_stunt.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/fernando/3381914087/'>
            http://www.flickr.com/photos/fernando/3381914087/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class='slide'>
      <header>CommonJS Compiler Concerns</header>
      <p class='slide'>Define <code>require</code></p>
      <p class='slide'>Convert files to module definitions</p>
      <p class='slide'>Optional: convert (vendor) globals to modules</p>
      <p class='slide'>Optional: export a single global</p>
    </section>

    <section class='slide'>
      <header>Browserification: Framework</header>
      <p>From <a href="https://github.com/maccman/sprockets-commonjs/blob/master/lib/assets/javascripts/sprockets/commonjs.js">Sprockets-CommonJS</a>:</p>
      <pre>var require = function(name, root) {
  ...
};
require.define = function(bundle) {
  ...
};</pre>
    </section>

    <section class='slide'>
      <header>Browserification: Compiler</header>
      <p>In <code>script/cjs2browser</code>:</p>
      <pre>#!/bin/sh

filename="$1";

echo <em>"require.define(\"${filename}\","</em>
echo "  function(exports, require, module) {";
<em>cat  $filename;</em>
echo "});";</pre>
    </section>

    <section class='slide'>
      <header>Browserification: Build Script</header>
      <pre>outfile="assets/insistent_cat.js"
node_modules/jshint/bin/jshint src || exit 1;
cat  script/commonjs_shim.js > $outfile;
echo "$(script/cjs2browser src/cat_image.js)" >> $outfile;
echo "$(script/cjs2browser src/cat_follower.js)" >> $outfile;
</pre>
    </section>

    <section class='slide'>
      <header>Problem!</header>
      <pre>var catImage = require('src/cat_image.js')</pre>
    </section>

    <section class='slide'>
      <header>"Solution"</header>
      <pre>sed -E 's/^src\/(.+)\.js$/\1/p'</pre>
      <img src="./assets/suspicious_about_sed.png" />
    </section>

    <section class='slide'>
      <header>Browserify: Installation</header>
      <pre>{
  "devDependencies": {
    "browserify": "~2.8.0"
  }
}</pre><pre>npm install</pre>
    </section>

    <section class='slide'>
      <header>Browserify: Export</header>
      <p>In <code>src/main.js</code>:</p>
      <pre>window.InsistentCat = require('./cat_follower');</pre>
    </section>

    <section class='slide'>
      <header>Browserify: Run</header>
      <pre>./node_modules/browserify/bin/cmd.js \
  src/main.js \
  > assets/insistent_cat.js</pre>
    </section>

    <section class="slide chapter green">
      <h1>Chapter 6: Make</h1>
    </section>

    <section class='slide'>
      <header>Power of Make</header>
      <p class='slide'>Decomposition</p>
      <p class='slide'>Use `mtime` to avoid work</p>
      <p class='slide'>First-class shell</p>
    </section>

    <section class='slide'>
      <header>Or...</header>
      <p>Rake, Jake, Paver, etc.</p>
    </section>

    <section class='slide'>
      <header>Start Simple</header>
      <pre>build:
  node_modules/jshint/bin/jshint src

  node_modules/browserify/bin/cmd.js \
    src/main.js \
    > assets/insistent_cat.js
    </section>

    <section class='slide'>
      <header><code>.PHONY</code></header>
      <pre>.PHONY: build</pre>
    </section>

    <section class='slide'>
      <header>Dependencies</header>
      <pre>build: assets/insistent_cat.js</pre>
    </section>

    <section class='slide'>
      <header>File Target</header>
      <pre>assets/insistent_cat.js: jshint
  node_modules/browserify/bin/cmd.js \
    src/main.js \
    > assets/insistent_cat.js</pre>
    </section>

    <section class='slide'>
      <header>File Target Dependency</header>
      <pre>jshint:
  node_modules/jshint/bin/jshint src

.PHONY: build jshint</pre>
    </section>

    <section class='slide'>
      <header><code>$@</code></header>
      <pre class='slide'><em>assets/insistent_cat.js</em>: jshint
  node_modules/browserify/bin/cmd.js \
    src/main.js \
    > <em>assets/insistent_cat.js</em></pre>
      <pre class='slide'>assets/insistent_cat.js: jshint
  node_modules/browserify/bin/cmd.js \
    src/main.js \
    > <em>$@</em></pre>
    </section>

    <section class='slide'>
      <header>Variables</header>
      <pre class='slide'>build: <em>assets/insistent_cat.js</em>

<em>assets/insistent_cat.js</em>: jshint</pre>
      <pre class='slide'><em>DIST_JS</em> = assets/insistent_cat.js
build: <em>$(DIST_JS)</em>
<em>$(DIST_JS)</em>: jshint</pre>
    </section>

    <section class='slide'>
      <header>Cleanup</header>
      <pre class='slide'>clean:
  -rm $(DIST_JS)
.PHONY: build clean</pre>
      <p class='slide'><code><em>-</em></code> prefix: can fail
    </section>

    <section class='slide'>
      <header>Too Much Work!</header>
      <figure>
        <img src="./assets/lazy_lizard.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/kpcauchi/5376768095/'>
            http://www.flickr.com/photos/kpcauchi/5376768095/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class='slide'>
      <header>File Marker Overview</header>
      <img src='./assets/make_lint_free_marker.png' />
    </section>

    <section class='slide'>
      <header>Lint-Free File Marker</header>
      <pre>SRC_DIR         = src
LINT_FREE_DIR   = tmp/lint_free
JS_FILES        := $(wildcard $(SRC_DIR)/*.js)
LINTED_JS_FILES := $(JS_FILES:$(SRC_DIR)/%=$(LINT_FREE_DIR)/%)

$(LINTED_JS_FILES): <em>$(LINT_FREE_DIR)/%.js : $(SRC_DIR)/%.js</em> $(LINT_FREE_DIR)
  node_modules/jshint/bin/jshint $&lt;
  <em>touch $@</em></pre>
    </section>

    <section class='slide'>
      <header>Compile after JSHint</header>
      <pre>$(DIST_JS): <em>$(LINTED_JS_FILES)</em>
  node_modules/browserify/bin/cmd.js \
    src/main.js \
    > $@</pre>
    </section>

    <section class='slide'>
      <header>Clean up marker files</header>
      <pre>clean:
  -rm $(DIST_JS)
  <em>-rm -rf $(LINT_FREE_DIR)</em></pre>
    </section>

    <section class="slide chapter green">
      <h1>Chapter 6b: Rake</h1>
    </section>

    <section class='slide'>
      <header>Rake: <code>:default</code> task</header>
      <pre class='slide'><em>desc</em> 'Build the InsistentCat Library'
task :build 'assets/insistent_cat.js'</pre>
      <pre class='slide'>task :default => :build</pre>
    </section>

    <section class='slide'>
      <header>Rake: file task</header>
      <pre>file 'assets/insistent_cat.js' => <em>LINT_FREE_FILES</em> do |t|
  browserify = 'node_modules/browserify/bin/cmd.js'
  main       = 'src/main.js'
  <em>sh</em> "#{browserify} #{main} > <em>#{t.name}</em>"
end</pre>
    </section>

    <section class='slide'>
      <header>Rake: Lint-Free Files</header>
      <pre class='slide'>def <em>lint_free_file</em>(source)
  source.sub %r{^#{SRC_DIR}}, LINT_FREE_DIR
end</pre>
      <pre class='slide'>LINTED_JS_FILES = JS_FILES.
  map { |f| lint_free_file(f) }</pre>
</pre>
    </section>

    <section class='slide'>
      <header>Rake: Lint-Free File Tasks</header>
      <pre>JS_FILES.each do |f|
  file <em>lint_free_file(f) => [ f, LINT_FREE_DIR ]</em> do |task|
    jshint = 'node_modules/jshint/bin/jshint'
    sh "#{jshint} #{<em>task.prerequisites.first</em>}"
    touch task.name
  end
end</pre>
    </section>

    <section class='slide'>
      <header>Rake: Extra Credit</header>
      <p class='slide'>"Marker File" for unit tests</p>
      <p class='slide'><code>=> test_file</code></p>
      <p class='slide'><code>=> file_under_test</code></p>
      <p class='slide'><code>=> dependencies</code></p>
    </section>

    <section class="slide chapter green">
      <h1>Chapter 7: File Watching</h1>
    </section>

    <section class='slide'>
      <header>The Watcher</header>
      <figure>
        <img src="./assets/rupert_giles.jpg" />
        <figcaption><cite>
          20th Century Fox Television
        </cite></figcaption>
      </figure>
    </section>

    <section class='slide'>
      <header>Watchdog: Fail</header>
      <div class='side-by-side'>
        <figure>
          <img src="./assets/hamster.jpg" />
          <figcaption><cite>
            <a href="http://www.flickr.com/photos/ianhampton/2317616360/">
              http://www.flickr.com/photos/ianhampton/2317616360/
            </a>
          </cite></figcaption>
        </figure>
        <figure>
          <img src="./assets/elderberries.jpg" />
          <figcaption><cite>
            <a href='http://www.flickr.com/photos/ibboard/8542522414/'>
              http://www.flickr.com/photos/ibboard/8542522414/
            </a>
          </cite></figcaption>
        </figure>
      </div>
    </section>

    <section class='slide'>
      <header>nodemon: Good, but...</header>
      <p class='slide'><code>nodemon --exec</code> passes changed file</p>
      <p class='slide'><code>rake dist <em>src/foo.js</em></code></p>
      <p class='slide'>Need extra command to drop args</p>
    </section>

    <section class='slide'>
      <header>Guard: Installation</header>
      <pre>gem install guard</pre>
    </section>

    <section class='slide'>
      <header>Guard: Configuration</header>
      <pre>guard :shell do
  watch(%r{^src/.*\.js}) { system 'rake', 'dist' }
end</pre>
    </section>

    <section class='slide'>
      <header>Guard: Running</header>
      <p class='slide'><code>guard</code></p>
      <p class='slide'><code>guard <em>&amp;</em></code></p>
    </section>

    <section class='slide'>
      <header>Guard: Extra Credit</header>
      <p>Growl notifications</p>
    </section>

    <!-- deck.status snippet -->
    <p class="deck-status">
      <span class="deck-status-current"></span>
      /
      <span class="deck-status-total"></span>
    </p>

    <!-- Required JS files. -->
    <script src="../deck/assets/jquery-1.7.2.min.js"></script>
    <script src="./assets/insistent_cat.js"></script>
    <script src="../deck/core/deck.core.js"></script>

    <!-- Extension JS files. Add or remove as needed. -->
    <script src="../deck/extensions/hash/deck.hash.js"></script>
    <script src="../deck/extensions/status/deck.status.js"></script>
    <script src="../deck/extensions/scale/deck.scale.js"></script>

    <!-- Initialize the deck. You can put this in an external file if desired. -->
    <script>
      $(function() {
        $(document).bind('deck.beforeInit', function() {
          $('.deck-container > .slide')
            .not('.chapter.green')
            .not('.buddhy')
              .each(function() {
                if ( $(this).find('header').length === 0 ) {
                  $(this).prepend('<header />');
                }
              });
        });

        $.deck('.slide');
        new InsistentCat('./assets/odd_eyed_cat.jpg', '5em');
      });
    </script>
  </body>
</html>
