<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=1024, user-scalable=no">

    <title>JavaScript Tools for Developer Happiness</title>

    <link rel="stylesheet" href="../deck/core/deck.core.css">
    <link rel="stylesheet" href="../deck/extensions/status/deck.status.css">
    <link rel="stylesheet" href="../deck/extensions/hash/deck.hash.css">
    <link rel="stylesheet" href="../deck/extensions/scale/deck.scale.css">
    <link rel="stylesheet" href="../deck/themes/transition/vertical-slide.css">
    <link rel="stylesheet" href="../deck/themes/style/zendesk.css">

    <script src="../deck/assets/modernizr.custom.js"></script>
  </head>
  <body class="deck-container">
    <!-- slides -->

    <section class="slide chapter green">
      <h1>
        JavaScript Tools<br />For Developer Happiness
        <cite>https://github.com/jamesarosen/presentations/javascript_equipment</cite>
      </h1>
    </section>

    <section class="slide chapter green">
      <h1>
        <img src="../deck/themes/style/buddhy.png" />
      </h1>
    </section>

    <section class="slide chapter green">
      <h1>Chapter 0: <code>whoami</code></h1>
    </section>

    <section class='slide'>
      <p>James A. Rosen</p>
      <p>Senior User Happiness Engineer, Zendesk</p>
      <p>@jamearosen</p>
      <p>https://github.com/jamesarosen</p>
    </section>

    <section class='slide chapter green'>
      <h1>Chapter 1: Tools Philosophy</h1>
    </section>

    <section class='slide'>
      <header>Working</header>
      <figure>
        <img src="./assets/broken_wrench.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/9115274@N05/577382652/'>
            http://www.flickr.com/photos/9115274@N05/577382652/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class='slide'>
      <header>Fast</header>
      <figure>
        <img src="./assets/cheetah.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/geyring/5290188093/'>
            http://www.flickr.com/photos/geyring/5290188093/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class='slide'>
      <header>Slow is OK</header>
      <figure>
        <img src="./assets/turkish_tea.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/mbgrigby/5161070259/'>
            http://www.flickr.com/photos/mbgrigby/5161070259/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class='slide'>
      <header>Polyglot</header>
      <figure>
        <img src="./assets/polyglot.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/quinnanya/5383598076/'>
            http://www.flickr.com/photos/quinnanya/5383598076/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class='slide'>
      <header>Overview</header>
      <ol>
        <li class='slide'>JSHint</li>
        <li class='slide'>Shell Scripting</li>
        <li class='slide'>CommonJS &amp; Browserify</li>
        <li class='slide'>Make</li>
      </ol>
    </section>

    <section class="slide chapter green">
      <h1>Chapter 2: <code>insistent_cat.js</code></h1>
    </section>

    <section class="slide">
      <header>User Story: Catness</header>
      <p>As a cat,</p>
      <p>I want to be directly under your hand, wherever it happens to be, regardless of what you are doing, all the time</p>
      <p>So that I epitomize catness.</p>
      <p><cite>
        <a href="https://twitter.com/catuserstories/status/311275434669142019" class='odd-eyed-cat'>
          https://twitter.com/catuserstories/status/311275434669142019
        </a>
      </cite></p>
    </section>

    <section class='slide'>
      <figure>
        <img src="./assets/odd_eyed_cat.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/ihasb33r/2573196546/'>
            http://www.flickr.com/photos/ihasb33r/2573196546/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class="slide chapter green">
      <h1>
        Chapter 3: JSHint<br />
        <span class='subtitle'>The <i>Sine Qua Non</i> of JavaScript Development</span>
      </h1>
    </section>

    <section class="slide">
      <header><i>Sine Qua Non</i></header>
      <pre>/ˌsaɪnɨ kweɪ ˈnɒn/ or /ˈsine kwaː ˈnoːn/

If you don't use this, I will smack you with a fish.

Origin: L, without which not</pre>
    </section>

    <section class="slide">
      <header>JSHint Installation</header>
      <ol>
        <li class='slide'>Go to <a href="http://nodejs.org/">http://nodejs.org/</a></li>
        <li class='slide'>Install NodeJS</a></li>
        <li class='slide'><code>npm install -g jshint</code><br />(more on this later)</li>
      </ol>
    </section>

    <section class="slide">
      <header>JSHint Usage</header>
      <pre class='slide'>jshint assets/insistent_cat.js</pre>
      <pre class='slide'>assets/insistent_cat.js: line 21, col 53,
Expected an assignment or function call and instead saw an expression.</pre>
    </section>

    <section class='slide'>
      <header>Before &amp; After</header>
      <pre class='slide'>cat.following ? cat.unfollow() : cat.follow();</pre>
      <pre class='slide'>if (cat.following) {
  cat.unfollow();
} else {
 cat.follow();
}</pre>
    </section>

    <section class='slide'>
      <header>JSHint Options</header>
      <ul>
        <li class='slide'><code>curly</code>: require <code>{...}</code></li>
        <li class='slide'><code>eqeqeq</code>: require <code>===</code> and <code>!==</code></li>
        <li class='slide'><code>undef</code>: spot leaked globals</li>
        <li class='slide'><code>unused</code>: spot extra variables</li>
        <li class='slide'>
          More at
          <a href="http://jshint.com/docs/#options">http://jshint.com/docs/#options</a>
        </li>
      </ul>
    </section>

    <section class='slide'>
      <header>JSHint: Multiple Versions</header>
      <p>
        You work on many projects; each prefers a specific version of JSHint
      </pre>
    </section>

    <section class='slide'>
      <header>Install Locally</header>
      <pre class='slide'>{
  "devDependencies": {
    "jshint": "~1.1.0"
  }
}</pre>
      <pre class='slide'>npm install</pre>
      <p class='slide'>Ignore warnings about <code>-g</code></p>
    </section>

    <section class='slide'>
      <header>Run Locally</header>
      <pre><em>node_modules/jshint/bin/jshint</em> myFile.js</pre>
    </section>

    <section class='slide'>
      <header>JSHint: Bonus Points</header>
      <ul>
        <li class='slide'>Run from editor w/ keyboard shortcut</li>
        <li class='slide'>Run from editor on save</li>
        <li class='slide'>Add to git pre-commit hook</li>
        <li class='slide'>Run in <abbr title="Continuous Integration">CI</abbr></li>
      </ul>
    </section>

    <section class="slide chapter green">
      <h1>Chapter 4: Working with Multiple Files</h1>
    </section>

    <section class='slide'>
      <header>JSHint: Multiple Files</header>
      <pre>node_modules/jshint/bin/jshint src</pre>
    </section>

    <section class='slide'>
      <header>Refactor</header>
      <p>In <code>script/hint</code>:</p>
      <pre>#!/bin/sh
node_modules/jshint/bin/jshint src</pre>
    </section>

    <section class='slide'>
      <header><code>cat</code></header>
      <pre>cat src/cat_image.js \
  src/cat_follower.js \
  > assets/insistent_cat.js</pre>
    </section>

    <section class='slide'>
      <header>Problem!</header>
      <pre>(function(window, $, undefined) {

  // contents go here

  window.InsistentCat = InsistentCat;

}(this, this.jQuery));</pre>
    </section>

    <section class='slide'>
      <header>"Solution"</header>
      <p>In <code>script/build</code>:</p>
      <pre>#!/bin/sh
outfile="build/library.js"
echo "(function(window, $, undefined) {"    >  $outfile;
cat  src/cat_image.js                       >> $outfile;
cat  src/cat_follower.js                    >> $outfile;
echo "window.InsistentCat = InsistentCat;"  >> $outfile;
echo "}(this, this.jQuery));"               >> $outfile;</pre>
    </section>

    <section class="slide chapter green">
      <h1>Chapter 5: Modularization</h1>
    </section>

    <section class='slide'>
      <header>Options</header>
      <ul>
        <li class='slide'>require.js - different name for globals</li>
        <li class='slide'>
          ES6 Modules (<code>es6-module-transpiler</code>) - promising, but
          in flux.
        </li>
        <li class='slide'>CommonJS - already using <code>npm</code>; large library set.</li>
      </ul>
    </section>

    <section class='slide'>
      <header>Export</header>
      <pre>// in cat_image.js:
<em>module.exports</em> = function buildCatImage(src, options) {
  // ...
};</pre>
    </section>

    <section class='slide'>
      <header>Import</header>
      <pre>// in cat_follower.js:
var <em>buildImage = require('./cat_image')</em>;
// ...
var catImage = buildImage('path/to/cat.png', { width: '20px' });
</pre>
    </section>

    <section class='slide'>
      <header>CommonJS -> Browser Compilers</header>
      <ul>
        <li class='slide'><a href="https://github.com/azer/onejs">OneJS</a></li>
        <li class='slide'><a href="https://github.com/mixu/gluejs">GlueJS</a></li>
        <li class='slide'><a href="https://github.com/substack/node-browserify">Browserify</a></li>
        <li class='slide'>Custom Shell Script</li>
      </ul>
    </section>

    <section class='slide'>
      <header>Caution!</header>
      <figure>
        <img src="./assets/motorcycle_stunt.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/fernando/3381914087/'>
            http://www.flickr.com/photos/fernando/3381914087/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class='slide'>
      <header>CommonJS Compiler Concerns</header>
      <p class='slide'>Define <code>require</code></p>
      <p class='slide'>Convert files to module definitions</p>
      <p class='slide'>Optional: convert (vendor) globals to modules</p>
      <p class='slide'>Optional: export a single global</p>
    </section>

    <section class='slide'>
      <header>Browserification: Framework</header>
      <p>From <a href="https://github.com/maccman/sprockets-commonjs/blob/master/lib/assets/javascripts/sprockets/commonjs.js">Sprockets-CommonJS</a>:</p>
      <pre>var require = function(name, root) {
  ...
};
require.define = function(bundle) {
  ...
};</pre>
    </section>

    <section class='slide'>
      <header>Browserification: Compiler</header>
      <p>In <code>script/cjs2browser</code>:</p>
      <pre>#!/bin/sh

filename="$1";

echo "require.define(\"${filename}\","
echo "  function(exports, require, module) {";
cat  $filename;
echo "});";</pre>
    </section>

    <section class='slide'>
      <header>Browserification: Build Script</header>
      <pre>outfile="assets/insistent_cat.js"
node_modules/jshint/bin/jshint src || exit 1;
cat  script/commonjs_shim.js > $outfile;
echo "$(script/cjs2browser src/cat_image.js)" >> $outfile;
echo "$(script/cjs2browser src/cat_follower.js)" >> $outfile;
</pre>
    </section>

    <section class='slide'>
      <header>Problem!</header>
      <pre>var catImage = require('src/cat_image.js')</pre>
    </section>

    <section class='slide'>
      <header>"Solution"</header>
      <pre>sed -E 's/^src\/(.+)\.js$/\1/p'</pre>
    </section>

    <section class='slide'>
      <header>Browserify: Installation</header>
      <pre>{
  "devDependencies": {
    "browserify": "~2.8.0"
  }
}</pre><pre>npm install</pre>
    </section>

    <section class='slide'>
      <header>Browserify: Export</header>
      <p>In <code>src/main.js</code>:</p>
      <pre>window.InsistentCat = require('./cat_follower');</pre>
    </section>

    <section class='slide'>
      <header>Browserify: Run</header>
      <pre>./node_modules/browserify/bin/cmd.js \
  src/main.js \
  > assets/insistent_cat.js</pre>
    </section>

    <section class="slide chapter green">
      <h1>Chapter 6: Make</h1>
    </section>

    <section class='slide'>
      <header>Or...</header>
      <p>Rake, Jake, Paver, etc.</p>
    </section>

    <section class='slide'>
      <header>Power of Make</header>
      <ul>
        <li class='slide'>Decomposition</li>
        <li class='slide'>Use `mtime` to avoid work</li>
        <li class='slide'>First-class shell</li>
      </ul>
    </section>

    <section class='slide'>
      <header>Start Simple</header>
      <pre>build:
  node_modules/jshint/bin/jshint src

  node_modules/browserify/bin/cmd.js \
    src/main.js \
    > assets/insistent_cat.js
    </section>

    <section class='slide'>
      <header><code>.PHONY</code></header>
      <pre>.PHONY: build</pre>
    </section>

    <section class='slide'>
      <header>Dependencies</header>
      <pre>build: assets/insistent_cat.js</pre>
    </section>

    <section class='slide'>
      <header>File Target</header>
      <pre>assets/insistent_cat.js: jshint
  node_modules/browserify/bin/cmd.js \
    src/main.js \
    > assets/insistent_cat.js</pre>
    </section>

    <section class='slide'>
      <header>File Target Dependency</header>
      <pre>jshint:
  node_modules/jshint/bin/jshint src

.PHONY: build jshint</pre>
    </section>

    <section class='slide'>
      <header><code>%@</code></header>
      <pre><em>assets/insistent_cat.js</em>: jshint
  node_modules/browserify/bin/cmd.js \
    src/main.js \
    > <em>$@</em></pre>
    </section>

    <section class='slide'>
      <header>Variables</header>
      <pre><em>DIST_JS</em> = assets/insistent_cat.js
build: <em>$(DIST_JS)</em>
<em>$(DIST_JS)</em>: jshint
  node_modules/browserify/bin/cmd.js</pre>
    </section>

    <section class='slide'>
      <header>Cleanup</header>
      <pre>clean:
  -rm $(DIST_JS)
.PHONY: build clean
    </section>

    <section class='slide'>
      <header>Too Much Work!</header>
      <figure>
        <img src="./assets/lazy_lizard.jpg" />
        <figcaption><cite>
          <a href='http://www.flickr.com/photos/kpcauchi/5376768095/'>
            http://www.flickr.com/photos/kpcauchi/5376768095/
          </a>
        </cite></figcaption>
      </figure>
    </section>

    <section class='slide'>
      <header>Lint-Free File Marker</header>
      <pre>SRC_DIR         = src
LINT_FREE_DIR   = tmp/lint_free
JS_FILES        := $(wildcard $(SRC_DIR)/*.js)
LINTED_JS_FILES := $(JS_FILES:$(SRC_DIR)/%=$(LINT_FREE_DIR)/%)

$(LINTED_JS_FILES): <em>$(LINT_FREE_DIR)/%.js : $(SRC_DIR)/%.js</em> $(LINT_FREE_DIR)
  node_modules/jshint/bin/jshint $&lt;
  <em>touch $@</em></pre>
    </section>

    <section class='slide'>
      <header>Compile after JSHint</header>
      <pre>$(DIST_JS): $(LINTED_JS_FILES)
  ...</pre>
    </section>

    <section class='slide'>
      <header>Clean up marker files</header>
      <pre>clean:
  -rm $(DIST_JS)
  -rm -rf $(LINT_FREE_DIR)</pre>
    </section>

    <!-- deck.status snippet -->
    <p class="deck-status">
      <span class="deck-status-current"></span>
      /
      <span class="deck-status-total"></span>
    </p>

    <!-- Required JS files. -->
    <script src="../deck/assets/jquery-1.7.2.min.js"></script>
    <script src="./assets/insistent_cat.js"></script>
    <script src="../deck/core/deck.core.js"></script>

    <!-- Extension JS files. Add or remove as needed. -->
    <script src="../deck/extensions/hash/deck.hash.js"></script>
    <script src="../deck/extensions/status/deck.status.js"></script>
    <script src="../deck/extensions/scale/deck.scale.js"></script>

    <!-- Initialize the deck. You can put this in an external file if desired. -->
    <script>
      $(function() {
        $(document).bind('deck.beforeInit', function() {
          $('.deck-container > .slide')
            .not('.chapter.green')
            .not('.buddhy')
              .each(function() {
                if ( $(this).find('header').length === 0 ) {
                  $(this).prepend('<header />');
                }
              });
        });

        $.deck('.slide');
        new InsistentCat('./assets/odd_eyed_cat.jpg', '5em');
      });
    </script>
  </body>
</html>
